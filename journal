#!/bin/bash
port=2826

############################################################
# Help                                                     #
############################################################
Help()
{
   # Display Help
   echo "journalNet Client Options:"
   echo "-b     Print the addresses in bookmarks.txt file."
   echo "-h     Print this Help."
   echo
   echo "Info: You can read journals with netcat:"
   echo "echo username | nc 127.0.0.1 2826" 

}


############################################################
# Bookmarks                                                #
############################################################
Bookmarks()
{
   # Display Bookmarks
   echo "Bookmark List"
   readarray -t Bookmarks < bookmarks.txt

PS3='Please enter your choice or 0 to exit: '
select selection in "${Bookmarks[@]}"; do
    if [[ $REPLY == "0" ]]; then
        echo -e '\033[1;30mHasta la vista, Baby!\033[0m' >&2
        exit
    else
        ./journal $selection
#If you copied the journalNet client (./journal) to /usr/bin just change the line above from "./journal" to "journal"        
        break
    fi
done
}

############################################################
# Process the input options. Add options as needed.        #
############################################################
################################
# Get the options
while getopts ":hb" option; do
   case $option in
      h) # display Help
         Help
         exit;;
      b) # display Bookmarks
         Bookmarks
         exit;;
     \?) # Invalid option
         echo "Error: Invalid option."
         exit;;
   esac
done


############################################################
# Main program                                             #
############################################################


usage()
{
    echo "JournalNet"
    echo "Usage: $(basename $0) user@host.example"
    exit 0
}

[[ -z "$@" ]] && usage

user="$(echo "$@" | cut -d @ -f 1)"
host="$(echo "$@" | cut -d @ -f 2)"

exec 3<>/dev/tcp/$host/$port
echo "$user" >&3
cat <&3
